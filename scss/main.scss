/* ----------------------------------------- */
/*  Sheet Styles                             */
/* ----------------------------------------- */
@keyframes notify {
  from {
    text-shadow: none;
  }

  to {
    text-shadow: -1px -1px 4px #4b4a44, 1px -1px 4px #4b4a44, -1px 1px 4px #4b4a44, 1px 1px 4px #4b4a44;
  }
}

.wwn {
  &.sheet.actor {
    .blinking {
      font-weight: bold;
      animation: 0.8s ease-in 1s infinite alternate notify;
    }

    .panel {
      border: 1px solid rgba(0, 0, 0, 0.9);

      .panel-title {
        color: whitesmoke;
        background: #252525;
        line-height: 12px;
        height: 20px;
        text-align: center;
        margin: 0;
        padding: 4px;
        display: flex;

        h4 {
          flex: 1;
        }

        .item-controls {
          font-size: 12px;
          flex: 0 0 18px;
        }
      }

      .panel-content {
        margin: 0;
        padding: 0;
      }
    }

    .header-details {
      h1 input {
        margin: 0 0 5px 0;
      }

      .summary .check-field {
        &:hover .check {
          display: block;
        }

        .check {
          display: none;
          line-height: 35px;
          flex: 0 0 20px;
          position: absolute;
          font-size: 12px;

          &:hover {
            color: rgba(0, 0, 0, 0.9);
          }
        }
      }
    }

    .profile-img {
      border: 0;
      flex: 0 0 145px;
      height: 145px;
      object-fit: contain;
    }

    .summary {
      flex: 0 0 100%;
      height: 44px;
      margin: 0;
      padding: 0;
      list-style: none;
      border-top: none;

      li {
        height: calc(100% - 6px);
        float: left;
        margin: 2px 0;
        padding: 0;
        line-height: 30px;
        color: #4b4a44;
        position: relative;

        label {
          line-height: 10px;
          position: absolute;
          font-size: 10px;
          color: #4b4a44;
          bottom: 0;
          left: 12px;
        }

        &.notify input {
          font-weight: bold;
          animation: 0.8s ease-in 1s infinite alternate notify;
        }
      }
    }

    .sheet-tabs {
      position: absolute;
      transform: rotate(90deg);
      bottom: 216px;
      right: -179px;
      width: 340px;
      border-top: none;
      z-index: -1;

      .item {
        padding: 1px 20px 3px;
        margin-left: -5px;
        text-indent: 4px;
        line-height: 16px;
        background: #d8d6c9;
        background-size: cover;
        border-top-right-radius: 4px;
        border-top-left-radius: 80px;
        border-bottom: 1px solid rgba(0, 0, 0, 0.15);
        box-shadow: 0 0 6px 1px rgba(0, 0, 0, 0.9);
        font-size: 12px;
        filter: brightness(0.9);

        &.active {
          filter: none;
          z-index: 1;
          font-weight: bold;
          text-shadow: none;
          margin-bottom: -1px;
          background: #d8d6c9;
          background-size: cover;
          box-shadow: 0 0 8px 2px rgba(0, 0, 0, 0.9);
        }
      }
    }

    .sheet-body {
      height: calc(100% - 140px);
      padding: 20px 10px 10px 10px;

      .tab {
        height: 100%;
      }

      .attributes {
        list-style: none;
        margin: 0;
        padding: 0;
        justify-content: space-evenly;

        .attribute {
          position: relative;
          border: 1px solid #7a7971;
          box-shadow: 0 0 2px #7a7971;

          .attribute-name {
            color: whitesmoke;
            padding: 2px;
            margin: 0;
            border: 1px solid rgba(0, 0, 0, 0.9);
            background: #252525;
            text-align: center;
          }

          height: 40px;

          .attribute-value {
            line-height: 36px;
            width: auto;
            min-width: 15px;
            text-align: center;
            padding: 4px;
          }

          .attribute-mod {
            border-left: 1px solid #7a7971;
            padding: 4px;
            text-align: center;
          }

          .attribute-value .sep {
            line-height: 24px;
          }
        }
      }

      .attribute-group {
        padding-left: 5px;
        padding-right: 0px;
        margin-right: 0px;
        max-width: 160px;
      }
    }

    &.monster .sheet-body .attributes-tab {
      section.flexrow {
        flex-direction: column;
      }

      flex-direction: row;
      flex-grow: 0;

      .attribute-value.flexrow {
        flex-direction: row;
      }
    }

    .sheet-body {
      .attribute-group.skill-group {
        margin-left: 0px;
        margin-right: 25px;
        padding-right: 0px;
        margin-bottom: 0px;
        width: 310px;
      }

      .inventory.skills {
        .item {
          border: 1px #b5b3a4 solid;
          border-top: none;
        }

        .skill-roll {
          margin-left: 4px;
        }
      }

      .attribute-group {
        .attributes {
          display: inline-block;
          flex-direction: column;
          margin-bottom: -10px;
        }

        &.skill-group .attributes {
          display: inline-block;
          padding-left: 0px;
          margin-right: 0px;
        }

        .attributes .attribute {
          display: flex;
          flex-direction: row;
          margin-bottom: 18px;
        }

        &.skill-group .attributes .attribute {
          display: flex;
          flex-direction: row;
          padding-left: 0px;
          height: 30px;
          line-height: 30px;
          width: 170px;
          margin-bottom: 0px;
        }
      }
    }
  }

  &.actor.character .sheet-body .inventory.skills {
    padding-left: 5px;
  }

  &.sheet.actor {
    .sheet-body .attribute-group {
      &.skill-group .attributes .attribute.skills {
        .attribute-value.unspent {
          padding-left: 23px;
        }

        select {
          height: 30px;
        }
      }

      .attributes .attribute .attribute-name {
        width: 40px;
        margin: 0;
        line-height: 35px;
      }

      &.skill-group .attributes .attribute .attribute-name {
        width: 100px;
        margin: 0 0 0 0;
        padding: 0 0 0 0;
        line-height: 25px;
      }

      .attributes .attribute {
        .attribute-name a {
          margin: auto;
        }

        .attribute-value {
          width: 45px;
        }
      }

      &.skill-group .attributes .attribute .attribute-value {
        line-height: 25px;
        padding: 0 10px 0 10px;
        width: 40px;
      }

      .attributes .attribute .attribute-value input {
        padding: 0;
      }
    }

    &.monster .sheet-body {
      .inventory {
        padding-top: 0px;
        margin-top: 0px;
        max-height: 380px;
        overflow: auto;
      }

      .attributes-tab .inventory {
        width: 420px;
      }
    }

    &.character .sheet-body .attributes-tab .inventory {
      .item-titles {
        margin-top: 2px;
      }

      .item-list {
        flex-wrap: wrap;
        flex-direction: column;
        height: 370px;
        justify-content: start;
      }

      .item-name {
        flex-basis: 20%;
        flex-shrink: 1;
        margin: 0;
      }

      &.skills .item-entry {
        max-width: 250px;
        flex-grow: 0;
      }
    }

    .sheet-body .inventory {
      .header-spells {
        line-height: 30px;
      }

      div.spells div.spells-parent li.item-titles div.field-long input[type="text"] {
        height: auto;
      }

      .item-titles {
        text-align: center;
        padding: 4px 0;
        border: 1px solid rgba(0, 0, 0, 0.9);
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.9);
        font-weight: 300;
        font-size: 13px;
        background: #252525;
        color: white;
        margin-top: 7px;
      }

      .spell-resources {
        margin-left: 4px;
      }
    }

    &.monster .inventory .item-titles {
      margin-top: 0px;
    }

    .sheet-body .inventory {
      .item-titles {
        .item-name {
          text-align: left;
          text-indent: 8px;
        }

        .item-name-short {
          text-align: left;
          text-indent: 2px;
          flex-basis: 25px;
        }

        input {
          color: white;
          margin: auto;
        }
      }

      .item-list {
        list-style: none;
        margin: 0;
        padding: 0;

        >* {
          line-height: 30px;
        }

        .item-summary {
          font-size: 13px;
          padding: 0 4px;
          line-height: 20px;
          box-shadow: 0 0 3px rgba(0, 0, 0, 0.9);

          .tag-list {
            padding: 0;
            margin: 0;
            list-style: none;
            display: flex;

            .tag {
              margin: 1px 2px;
              border: 1px solid #d8d6c9;
              font-size: 11px;
              line-height: 14px;
              background: #4b4a44;
              padding: 1px 4px;
              color: whitesmoke;
              border-radius: 3px;
              box-shadow: 0 0 1px #d8d6c9;
            }
          }
        }

        .item-header {
          padding: 0px;
          margin-bottom: 0px;
        }

        .item-entry:nth-child(even) .item {
          background: rgba(0, 0, 0, 0.1);
        }

        .item {
          line-height: 30px;
          height: 30px;
          overflow: hidden;
        }

        .item-equipped {
          grid-area: item-equipped;
          justify-self: center;
        }

        .item-rollable {
          &:hover .item-image {
            background-image: url("/icons/svg/d20-grey.svg") !important;
            cursor: pointer;
          }

          .item-image:hover {
            background-image: url("/icons/svg/d20-black.svg") !important;
          }
        }

        .item-name {
          text-indent: 8px;
          text-align: left;
          overflow: hidden;
          height: 30px;
          margin: 0;
          line-height: 30px;
          flex-basis: 90px;

          .item-image {
            flex-basis: 30px;
            flex-grow: 0;
            background-size: contain;
            background-repeat: no-repeat;
          }

          h4 {
            margin: 0;
          }
        }
      }

      .icon-row {
        img {
          border: none;
          margin: 3px 1px;
          flex: 0 0 24px;
        }

        span {
          font-size: 12px;
          flex-grow: 0;
        }
      }

      .field-flex {
        flex: 1;
        text-align: left;
        font-size: 12px;
        text-indent: 8px;
      }

      .field-longer {
        text-indent: 8px;
        text-align: left;
        flex-basis: 80px;
        font-size: 12px;
      }

      .field-long {
        flex-basis: 80px;
        flex-grow: 0;
        text-align: center;
        font-size: 12px;

        &.memorize input {
          border-bottom: none;
          margin: 3px 0;
        }
      }

      .field-xlong {
        font-size: 12px;
        flex-basis: 200px;
        flex-grow: 0;
        text-align: center;
      }

      .field-short {
        font-size: 12px;
        flex-basis: 45px;
        flex-grow: 0;
        text-align: center;
      }

      .field-xshort {
        font-size: 12px;
        flex-basis: 16px;
        flex-grow: 0;
        text-align: center;
      }

      .field-short.quantity {
        display: flex;

        input {
          margin: 3px 0;
          border-bottom: none;
        }
      }

      .item-caret {
        flex: 0 0 10px;
        margin: 0 4px;
        cursor: pointer;
      }

      .item-controls {
        font-size: 12px;
        flex-basis: 60px;
        flex-grow: 0;
        text-align: right;
        margin-right: 4px;
      }

      .item-controls-short {
        font-size: 12px;
        flex-basis: 15px;
        flex-grow: 0;
        text-align: right;
        margin-right: 1px;
      }

      .item-controls {

        .item-off,
        .item-unequipped,
        .item-unstowed,
        .item-unprepared {
          color: rgba(0, 0, 0, 0.2);
        }

        a:hover {
          color: #44191a;
          text-shadow: 0 0 5px #d8d6c9, 1px 0 5px #d8d6c9, 0 1px 5px #d8d6c9, 1px 1px 5px #d8d6c9;
        }
      }
    }

    .hidden {
      display: none;
    }

    .sheet-body .inventory.spells {
      .item-titles {
        line-height: 13px;
      }

      .item-controls {
        flex-basis: 65px;
      }
    }

    .inventory {
      &.spells {
        .spells-parent .item-list.spells-child {
          display: flex;
          flex-direction: row;
          flex-wrap: wrap;
        }

        .item-list .item-entry {
          flex-direction: column;
          flex-shrink: 1;
          flex-basis: 50%;

          .item.flexrow {
            flex-basis: 100%;
            flex-grow: 2;
            flex-shrink: 1;

            &.expanded {
              display: flex;
              flex-shrink: 0;
            }
          }
        }
      }

      .inventory-right .currency-header {
        color: whitesmoke;
        padding: 2px;
        padding-top: 4px;
        margin: 2px 0px 0px 4px;
        border: 1px solid rgba(0, 0, 0, 0.9);
        background: #252525;
        text-align: center;
        vertical-align: middle;
        height: 30px;
      }

      .currency {
        position: relative;
        padding-top: 2px;
        padding-bottom: 2px;
        border: 1px solid #000000;
        box-shadow: 0 0 2px #7a7971;
        margin-top: 2px;
        margin-bottom: 0px;
        display: flex;
        width: 10px;
        vertical-align: middle;
        height: 30px;
      }
    }
  }

  &.actor .inventory .currency-adjust {
    padding-left: 14px;
    padding-right: 14px;
    color: #d8d6c9;

    &:hover {
      color: white;
    }
  }

  &.sheet.actor {
    .flexrow {
      .readied-header {
        color: whitesmoke;
        padding: 2px;
        padding-top: 4px;
        padding-bottom: 0px;
        margin: 2px 0px 0px 4px;
        border: 1px solid rgba(0, 0, 0, 0.9);
        background: #252525;
        text-align: center;
        vertical-align: middle;
        height: 30px;
      }

      .readied {
        position: relative;
        padding-top: 2px;
        padding-bottom: 2px;
        border: 1px solid #000000;
        box-shadow: 0 0 2px #7a7971;
        margin-top: 2px;
        display: flex;
        width: 10px;
        vertical-align: middle;
        height: 30px;
      }
    }

    .inventory {
      .inventory-all .inventory-right .item-titles {
        flex-grow: 0;
        height: 26px;
        line-height: 21px;
        width: 98%;
        margin-left: 4px;
      }

      .inventory-right {
        &.flexrow {
          flex-direction: column;

          .flexrow.readied-group {
            flex-direction: column;
          }
        }

        .flexrow.currency-group {
          flex-direction: column;
        }

        &.flexrow .flexrow.readied-group .flexrow.readied-subgroup {
          height: 10px;
        }

        .flexrow.currency-group .currency-subgroup.currency-buffer {
          margin-top: 7px;
        }
      }
    }

    .flexrow .unspentPoints {
      display: flex;
      border: 1px solid #000000;
      box-shadow: 0 0 2px #7a7971;
    }

    .sheet-body .editor {
      height: 300px;
      padding: 4px;
    }
  }

  &.roll-dialog .roll-details {
    font-weight: bold;
    text-align: center;
  }

  &.dialog {
    &.creator {
      .attribute-list .form-fields {
        flex: 0 0 50px;

        input {
          text-align: center;
          font-weight: bold;
        }
      }

      .roll-stats {
        flex: 0 0 65px;
        padding: 5px;
        margin-left: 4px;
        border-left: 1px solid #7a7971;

        .form-group .form-fields span {
          text-align: center;
          line-height: 24px;
          flex: 0;
        }
      }
    }

    &.party-xp {
      .actors {
        height: 270px;
        padding: 0;
        overflow-y: auto;

        .form-group input {
          max-width: 100px;
        }
      }

      .form-group button {
        line-height: 18px;
        flex-grow: 0;
      }
    }

    &.party-sheet {
      min-width: 250px;
      min-height: 250px;

      .window-content {
        padding: 0;
      }

      .header {
        color: whitesmoke;
        background: #252525;
        padding: 4px 0;
        line-height: 20px;
        text-align: left;
        padding: 2px 10px;

        .item-controls .item-control {
          padding: 0 2px;

          button {
            line-height: 15px;
            margin: 0 1px;
            background: rgba(255, 255, 240, 0.8);
            border: 1px solid #b5b3a4;
          }
        }
      }

      .actor-list {
        margin: 0;
        overflow: auto;
        list-style: none;
        padding: 0;

        .actor {
          border-bottom: 1px solid #7a7971;
          border-top: 1px solid #7a7971;
          margin-bottom: 2px;
          font-size: 12px;
          text-align: center;

          .fas {
            padding: 0 2px;
            font-size: 10px;
          }

          .fields .field-row:nth-child(odd) {
            background-color: rgba(0, 0, 0, 0.1);
          }

          .field-img {
            flex: 0 0 50px;
            position: relative;
            object-fit: contain;

            &:hover .img-btns button {
              display: block;
            }

            img {
              border: none;
              width: 45px;
              height: 45px;
            }

            .img-btns {
              position: absolute;
              bottom: 6px;
              left: 3px;
              width: 45px;
              height: 12px;

              button {
                display: none;
                cursor: pointer;
                font-size: 10px;
                height: 18px;
                width: 14px;
                line-height: 13px;
                margin: 0 1px;
                border: 1px solid #4b4a44;
                padding: 2px;
                background: #d8d6c9;
                box-shadow: inset 0 0px 3px #7a7971;
              }
            }
          }
        }
      }

      .field-name {
        text-align: left;
        text-indent: 10px;
      }
    }
  }
}

#sidebar #actors .directory-header .header-search {
  .wwn-party-sheet {
    width: 32px;
    height: 25px;
    text-align: center;
    line-height: 23px;
    margin: 4px;
  }

  input {
    width: calc(100% - 45px);
  }
}

.wwn.dialog.modifiers .attribute-bonuses {
  label {
    font-weight: bold;
  }

  ol {
    list-style: outside;
  }
}

.sheet.roll-table-config {
  .sheet-header .toggle-treasure {
    flex: 0 0 30px;
    font-size: 26px;
    line-height: 25px;
    color: white;
    margin: 0 2px 5px 8px;
    border-radius: 8px;
    background: url("/systems/wwn/assets/treasure.png") no-repeat center;
    background-size: cover;
    padding: 5px 8px;
    cursor: pointer;
    filter: grayscale(1) opacity(0.5);

    &.active,
    &:hover {
      filter: none;
    }
  }

  .results .table-result.active {
    animation: 0.7s infinite alternate activated;
  }
}

@keyframes activated {
  from {
    background: none;
  }

  to {
    background: rgba(0, 0, 0, 0.12);
  }
}

#settings .wwn.game-license {
  font-size: 12px;
  padding: 10px;
  flex-basis: 100%;

  .button {
    text-align: center;
    margin: 4px;
  }

  .footer {
    text-align: right;
  }
}

.wwn {
  &.chat-block {
    margin: 0;

    .chat-header {
      height: 46px;
      margin: 4px 0;
      background: #252525;
      border: 1px solid black;
      border-radius: 3px;
      color: white;
      padding: 2px;
      box-shadow: 0 0 2px #fff inset;

      .chat-title {
        color: #ebe8da;
        margin: 4px 0;
        height: 30px;
        overflow: hidden;

        h2 {
          color: #ebe8da;
          border: none;
          line-height: 34px;
          margin: 0;
          text-indent: 10px;
          font-size: 16px;
          word-break: break-all;
        }
      }

      .chat-img {
        flex: 0 0 42px;
        background-size: cover;
      }
    }

    .chat-target {
      text-align: right;
      font-style: italic;
      padding: 2px;
    }

    .chat-details {
      padding: 4px;
      font-size: 13px;
    }

    .roll-result {
      font-size: 13px;
      text-align: center;

      &.roll-success {
        color: #18520b;
      }

      &.roll-fail {
        color: #aa0200;
      }
    }

    .damage-roll {
      position: relative;
    }

    .chat-details.shock-message {
      max-height: 24px;
    }

    .shock-message .dice-damage {
      position: relative;
      bottom: 20px;
      right: -234px;
      max-height: 0px;
    }

    .damage-roll .dice-damage {
      position: absolute;
      line-height: 24px;
      text-align: center;
      background: rgba(0, 0, 0, 0.1);
      border-radius: 3px;
      box-shadow: 0 0 2px #fff inset;
      bottom: 1px;
      right: 10px;

      button {
        position: relative;
        top: -2px;
      }
    }

    .chat-details .dice-damage {
      display: inline-block;
    }

    .dice-damage button {
      padding: 2px 5px;
      width: 22px;
      line-height: 14px;
      height: 22px !important;
      max-height: 22px !important;
      min-height: 22px !important;
      cursor: pointer;
    }

    .initiative-header {
      background: #252525;
      color: white;
      padding: 8px;
      text-align: center;
      font-weight: bold;
      border-radius: 4px 4px 0 0;
      margin-bottom: 8px;
    }

    .initiative-roll {
      padding: 8px 0;

      .roll-header {
        font-weight: bold;
        margin-bottom: 4px;
      }
    }
  }

  &.chat-card {
    font-style: normal;
    font-size: 12px;

    .card-header {
      padding: 3px 0;
      border-top: 2px groove #fff;
      border-bottom: 2px groove #fff;

      img {
        flex: 0 0 36px;
        margin-right: 5px;
        border: none;
      }

      h3 {
        flex: 1;
        margin: 0;
        line-height: 36px;
        color: #4b4a44;

        &:hover {
          color: #111;
        }
      }
    }

    .card-content {
      margin: 5px 0;

      .treasure-list {
        padding: 0;
        list-style: none;

        .treasure {
          line-height: 36px;

          img {
            flex: 0 0 36px;
            border: none;
          }

          div {
            text-indent: 10px;
            font-size: 14px;
            font-weight: bold;
          }
        }

        .sub {
          padding-left: 25px;
          line-height: 28px;

          img {
            flex: 0 0 28px;
            border: none;
          }

          div {
            text-indent: 10px;
            font-size: 14px;
          }
        }
      }

      h3 {
        font-size: 12px;
        margin: 0;
        font-weight: bold;
      }

      >* {
        -webkit-user-select: text;
        -moz-user-select: text;
        -ms-user-select: text;
        user-select: text;
      }
    }

    .card-buttons {
      margin: 5px 0;

      span {
        display: block;
        line-height: 28px;
        text-align: center;
        border: 1px solid #7a7971;
      }

      button {
        font-size: 12px;
        height: 14px;
        margin: 2px 0;
        width: 100%;

        &.middle {
          margin: 4px 4px;
        }

        &.double-width {
          flex-grow: 2;
        }
      }
    }

    .card-footer {
      padding: 3px 0 0;
      border-top: 2px groove #fff;

      span {
        border-right: 2px groove #fff;
        padding: 0 5px 0 0;
        font-size: 10px;

        &:last-child {
          border-right: none;
          padding-right: 0;
        }
      }
    }
  }
}

.dice-roll .dice-total {
  &.success {
    color: inherit;
    background: #c7d0c0;
    border: 1px solid #006c00;
  }

  &.failure {
    color: inherit;
    background: #ffdddd;
    border: 1px solid #6e0000;
  }

  &.critical {
    color: green;
  }

  &.fumble {
    color: red;
  }
}

/* ----------------------------------------- */
/*  Sheet Styles                             */
/* ----------------------------------------- */
/* ----------------------------------------- */
/*  Basic Structure                          */
/* ----------------------------------------- */

.wwn.sheet.actor.character {
  min-width: 450px;
  min-height: 550px;

  /* ----------------------------------------- */
  /*  Sheet Header                             */
  /* ----------------------------------------- */
  /* ----------------------------------------- */
  /*  Sheet Body                               */
  /* ----------------------------------------- */
  /* ----------------------------------------- */
  /*  Item Controls                            */
  /* ----------------------------------------- */

  .sheet-header .xp-bonus {
    top: -15px;
    right: 3px;
    color: #7a7971;
    font-size: 10px;
    position: absolute;
  }

  .sheet-body {
    .tab {
      height: 100%;
    }

    .attributes-tab {
      justify-content: space-between;
      height: 95%;
    }
  }

  /* Add container query for spells tab detection */
  container-type: inline-size;
  container-name: character-sheet;

  .sheet-tabs {
    position: absolute;
    transform: rotate(90deg);
    bottom: 216px;
    // Default position when spells tab is absent
    right: -179px;
    width: 340px;
    border-top: none;
    z-index: -1;

    // When spells tab is present (detected by class)
    .has-spells & {
      right: -185px; // Move tabs slightly down by adjusting right value
    }

    .item {
      padding: 1px 20px 3px;
      margin-left: -5px;
      text-indent: 4px;
      line-height: 16px;
      background: #d8d6c9;
      background-size: cover;
      border-top-right-radius: 4px;
      border-top-left-radius: 80px;
      border-bottom: 1px solid rgba(0, 0, 0, 0.15);
      box-shadow: 0 0 6px 1px rgba(0, 0, 0, 0.9);
      font-size: 12px;
      filter: brightness(0.9);

      &.active {
        filter: none;
        z-index: 1;
        font-weight: bold;
        text-shadow: none;
        margin-bottom: -1px;
        background: #d8d6c9;
        background-size: cover;
        box-shadow: 0 0 8px 2px rgba(0, 0, 0, 0.9);
      }
    }
  }
}

#selectAttribute {
  padding: 0px;
  text-align: center;
  font-size: 13px;
  color: whitesmoke;
  margin-top: 0px;
  margin-left: 20px;
  margin-bottom: 0px;
  border: 1px solid rgba(0, 0, 0, 0.9);
  background: #252525;
  text-align: center;
  flex: 60px;
}

.form-group .form-fields #unspentPoints {
  padding: 0px;
  text-align: center;
  font-size: 13px;
  color: whitesmoke;
  margin-top: 0px;
  margin-left: 20px;
  margin-bottom: 0px;
  margin-right: 0;
  border: 1px solid rgba(0, 0, 0, 0.9);
  background: #252525;
  text-align: center;
  flex: 60px;
}

.wwn {
  &.sheet.actor.character .sheet-body {
    .attributes-tab .attribute-group {
      position: relative;
      padding-right: 0px;
      margin-right: 0px;
      padding-bottom: 0px;

      .modifiers-btn {
        position: absolute;
        left: 0;
        top: -23px;
      }
    }

    .resources {
      display: flex;
      justify-content: space-evenly;
      flex-direction: column;
      padding-right: 0px;
      padding-left: 0px;
      margin-left: 0px;
      margin-right: 0px;

      .attribute {
        flex: 0 0 15px;
      }
    }

    .middle-column {
      margin-left: -30px;
      margin-right: 0px;
      padding-right: 0px;
      padding-left: 0px;

      .resources {

        .health-bottom,
        .health.armor-class {
          margin-top: 20px;
        }
      }

      .attribute-group {
        margin: 5px 10px 0 25px;
        padding: 10px 10px 0 10px;

        .attributes {
          width: 110px;
          display: flex;
          flex-direction: column;

          .attribute {
            margin-bottom: 14px;
          }

          .attribute-name.box-title {
            width: 80px;
            line-height: 35px;
          }
        }
      }
    }
  }

  &.actor.character .sheet-body .attributes-tab {
    .attributes.saves {
      margin-top: 10px;
    }

    .attribute-group .attributes.saves .attribute.saving-throw .attribute-name {
      width: 85px;
      height: 38px;
    }
  }
}

.wide-attribute {
  width: 85px !important;
}

.wwn {
  &.actor.character .sheet-body .attributes-tab .attribute-group .attributes.saves .attribute-value {
    padding-bottom: 0px;
  }

  &.sheet.actor.character .sheet-body .notes-tab .inventory {
    .languages {
      margin: 2px;
      margin-top: 0px;
      flex: 0 0 130px;
    }

    flex-grow: 1;
    flex-shrink: 1;
    display: flex;
    flex-direction: column;

    .details-top {
      display: flex;
      flex-shrink: 1;
      flex-grow: 1;
    }

    .languages {
      .item-titles .item-controls {
        flex: 0 0 20px;
      }

      ol li {
        margin: 0;

        &:hover .item-controls {
          display: flex;
        }

        .item-controls {
          flex: 0 0 20px;
          display: none;
        }
      }
    }

    .description {
      margin: 2px;

      .editor {
        display: flex;
        flex-direction: column;
        flex-grow: 0;
        height: 100%;
        min-height: 120px;
      }

      .editor-content {
        min-height: 120px;
      }

      .editor .tox .tox-tbtn {
        height: 24px;
      }
    }

    .notes {
      margin: 2px;

      .editor {
        min-height: 120px;
        display: flex;
        flex-direction: column;
        flex-grow: 1;
        flex-shrink: 0;
        height: 100%;
      }

      .editor-content {
        min-height: 120px;
      }
    }
  }

  .window-content {
    .collapsed {
      display: none;
    }

    .margin {
      margin: 5px;
    }

    input {
      text-align: center;

      &:not([type="checkbox"]) {
        background: none;
        border: none;
        border-radius: 0;
        border-bottom: none;
      }
    }

    .header-details input:not([type="checkbox"]) {
      background: none;
      border: none;
      border-radius: 0;
      border-bottom: 1px solid #7a7971;
    }

    input:not([type="checkbox"]) {

      &:hover:not(:disabled),
      &:focus:not(:disabled) {
        box-shadow: none;
        background: linear-gradient(transparent, rgba(0, 0, 0, 0.1));
      }
    }

    a:hover {
      text-shadow: none;
    }

    .resizable {
      overflow: auto;
    }
  }

  &.sheet.item {
    .sheet-header {
      h1 input {
        margin: 6px 2% 0 20px;
      }

      .details {
        flex: 0 0 90px;

        label {
          flex: 0 0 20px;
        }
      }
    }

    .sheet-body .skill-details {
      flex-basis: 32%;
      flex-grow: 0;

      label {
        flex: 0 0 60px;
      }

      .form-group {
        justify-content: space-around;
      }

      .form-fields {
        flex-basis: 35%;
        flex-grow: 0;
      }
    }

    .sheet-header {
      .profile-img {
        border: none;
        flex: 0 0 84px;
        height: 84px;
      }

      .tag-list {
        margin: 0;
        height: 24px;
        overflow: auto;
        list-style: none;
        padding: 1px;
        display: flex;
        flex-wrap: wrap;

        .tag {
          background: #4b4a44;
          border-radius: 5px;
          color: whitesmoke;
          padding: 1px 5px;
          height: 18px;
          box-shadow: 0 0 3px #d8d6c9;
          margin: 0 2px;

          i {
            font-size: 8px;
            vertical-align: top;
            color: #d8d6c9;
          }
        }
      }
    }

    .sheet-body {
      .stats {
        flex: 0 0 80px;
        border: 1px groove rgba(0, 0, 0, 0.2);
        padding: 2px;
        font-size: 13px;

        .form-group {
          margin: 1px;
          border: 1px solid rgba(0, 0, 0, 0.15);

          label {
            background: rgba(0, 0, 0, 0.1);
            padding: 0 4px;
            white-space: nowrap;
            text-align: center;
          }

          input {
            border-bottom: none;
            margin: auto 0;
          }
        }

        .form-fields.attack-type {
          text-align: center;
          padding: 2px;
          padding-left: 8px;
          font-size: 15px;

          a {
            color: #969696;

            &.active {
              color: rgba(0, 0, 0, 0.9);
            }
          }
        }

        .form-group {
          &.attack-type a :hover {
            color: rgba(0, 0, 0, 0.9);
          }

          align-items: inherit;
          min-width: 250px;

          label {
            line-height: 21px;
            min-width: 135px;
            display: inline-block;
          }

          .form-fields {
            justify-content: space-evenly;
            height: 22px;

            select {
              height: 24px;
              white-space: nowrap;
              display: inline-block;
            }
          }
        }

        .block-input {
          display: flex;
          flex-direction: column;
          text-align: center;
        }

        &.narrow .form-group input {
          height: 18px;
        }
      }

      .description .editor {
        min-height: 300px;
        margin-bottom: 0;
      }

      .item-footer {
        justify-content: center;
        margin-bottom: 15px;
        justify-self: flex-end;
        bottom: 0;
        position: sticky;
      }

      .flexrow.card-body {
        flex-direction: column;
        justify-content: space-between;
      }

      .description .editor .editor-content {
        min-height: 320px;
        margin-bottom: 0;
      }
    }
  }

  &.actor.monster {
    min-height: 565px;
    min-width: 480px;

    .header-details .summary {
      .treasure-table {
        text-align: center;
      }

      .check-field {
        &:hover .check {
          display: block;
        }

        .check {
          display: none;
          line-height: 35px;
          flex: 0 0 20px;
          position: absolute;
          font-size: 12px;

          &:hover {
            color: rgba(0, 0, 0, 0.9);
          }
        }
      }
    }

    .sheet-body {
      .editor {
        height: 350px;
      }

      .attributes-tab {
        display: flex;
        justify-content: space-around;
        flex-direction: column;
        height: 100%;
        margin-bottom: 0px;

        .attribute-row {
          .attributes {
            justify-content: space-between;
          }

          .attribute-group {
            margin: 5px;
          }
        }

        .attributes .attribute {
          flex: 0 0 60px;
          max-width: 80px;
          height: 55px;
          margin: 0px 10px 10px 10px;

          .attribute-value {
            line-height: 15px;
          }

          &.health {
            flex: 0 0 85px;
          }
        }
      }
    }

    .attributes .attribute.health {
      position: relative;

      .attribute-name .hp-roll {
        font-size: 12px;
        position: absolute;
        right: 5px;
        top: 5px;
        color: #d8d6c9;

        &:hover {
          color: white;
        }
      }
    }

    .attribute-group .attacks-description {
      margin: 2px 0 25px;
      padding: 0;
      text-align: center;
      border-bottom: 1px solid #7a7971;

      label {
        color: #7a7971;
        font-size: 10px;
      }
    }

    .panel.abilities .item-list .item-entry .item-pattern {
      flex: 0 0 15px;
      cursor: pointer;
    }
  }
}

/* TODO: Fix item description sizing */

.greyrow {
  color: #777777;
}

.prepared {
  font-size: 10px;
  padding-left: 10px;
}

.checkbox_input {
  display: block;
}

.column {
  float: left;
  width: 50%;
  padding: 10px;
}

.row.after {
  content: "";
  display: table;
  clear: both;
}

.dialog-tweaks .row .column {
  .form-group label {
    min-width: 140px;
  }

  .header {
    text-align: center;
    font: bold;
  }
}

.currency-adjustment {
  flex-direction: "column";
}

/* ----------------------------------------- */
/*  Combat Styles                            */
/* ----------------------------------------- */

.combat-set-groups {
  container-name: combat-set-groups;
  container-type: inline-size;
  --grid: 1fr;

  .window-content {
    overflow-y: scroll;
    max-height: 700px;
  }

  ol {
    list-style-type: none;
    display: grid;
    grid-template-columns: var(--grid);
    gap: 0.75em 2em;
    margin: 0;
    padding: 0;
  }
}

@container combat-set-groups (min-width: 80ch) {
  .combat-set-groups ol {
    --grid: repeat(2, 1fr);
  }
}

@container combat-set-groups (min-width: 160ch) {
  .combat-set-groups ol {
    --grid: repeat(3, 1fr);
  }
}

@container combat-set-groups (min-width: 240ch) {
  .combat-set-groups ol {
    --grid: repeat(4, 1fr);
  }
}

.combat-set-groups__combatant {
  display: grid;
  grid-template-columns: 1fr fit-content;
  align-items: center;
  gap: 0.25em;
  font-size: var(--font-size-16);
}

.combat-set-groups__combatant__header {
  display: flex;
  gap: 0.5em;
  align-items: center;
}

.combat-set-groups__combatant__name {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.combat-set-groups__combatant img {
  max-width: 32px;
  height: auto;
}

.combat-set-groups__combatant__group-options {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 0.5em 1em;

  label.checkbox {
    align-items: baseline;
    opacity: 0.5;
    display: block;
    padding: 0.25em;
    border-radius: 4px;
    text-align: center;
    background-color: var(--combat-set-option-bg);
    color: var(--combat-set-option-font-color, white);
    font-weight: bold;
    cursor: pointer;
    line-height: 1.5em;

    input {
      display: none;
    }

    &:has(input:checked) {
      opacity: 1;
    }

    &:has(input[value="green"]) {
      --combat-set-option-bg: green;
    }

    &:has(input[value="red"]) {
      --combat-set-option-bg: red;
    }

    &:has(input[value="yellow"]) {
      --combat-set-option-bg: yellow;
      --combat-set-option-font-color: black;
    }

    &:has(input[value="purple"]) {
      --combat-set-option-bg: purple;
    }

    &:has(input[value="blue"]) {
      --combat-set-option-bg: blue;
    }

    &:has(input[value="orange"]) {
      --combat-set-option-bg: orange;
      --combat-set-option-font-color: black;
    }

    &:has(input[value="white"]) {
      --combat-set-option-bg: #92bbc9;
      --combat-set-option-font-color: black;
    }
  }
}

/* ----------------------------------------- */
/*  Combat Styles                            */
/* ----------------------------------------- */

.wwn {
  .faction-field {
    flex: 0 0 50px;
    font-size: 12px;
    text-align: center;
    padding-left: 8px;
  }

  .faction-field-wide {
    flex: 0 0 90px;
    font-size: 12px;
    text-align: left;
    padding-left: 8px;

    &.damage {
      flex: 0 0 110px;
      text-align: left;
    }
  }

  .faction-field.counter {
    text-align: left;
  }

  .item-titles .faction-field {
    text-align: center;
    justify-content: center;
  }

  &.sheet.actor {
    .sheet-body .inventory {
      .item-list .item-name.faction-name {
        flex-basis: 65px;
      }

      .item-controls {
        flex: 0 0 80px;
        padding: 0 4px;
        margin-right: 2px;

        a {
          margin-right: 0 2px;
        }
      }
    }

    .faction-header {
      /* Add any specific header styles */
    }

    .faction-header-img {
      flex: 0 0 100px;
      height: 100px;
    }

    .faction-header-summary {
      align-items: center;
    }

    .faction-header-active {
      flex: 2;
      line-height: normal;
      display: flex;
      align-items: center;
      margin-right: 10px;
    }

    .faction-header-turn {
      flex: 2;
      line-height: normal;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 5px;

      .cost {
        display: flex;
        align-items: center;
      }

      span {
        padding-left: 5px;
      }
    }

    .faction-header-homeworld {
      flex: 3;
      line-height: normal;
      margin-right: 15px;
      text-align: center;
    }

    .faction-header-magic {
      flex: 2;
      line-height: normal;
      text-align: center;
    }

    .faction-header-homeworld label,
    .faction-header-magic label {
      position: auto;
      left: 0;
      width: 100%;
      text-align: center;
      bottom: 0;
      margin: 0;
      right: 0;
      padding-right: 12px;
    }
  }
}

/* Override for attack damage column to be wider and left-aligned */

/* Override for counter to be left-aligned */

/* Center align the header cells for Rating and HP */

/* Override the item-name width specifically for faction assets */

/* Adjust the controls section */

/* Ensure consistent spacing between icons */

/* ----------------------------------------- */
/*  Sheet Styles                             */
/* ----------------------------------------- */

/* ----------------------------------------- */
/*  Faction Header Styles                    */
/* ----------------------------------------- */

/* Container toggle arrow */

.container-arrow {
  flex: 0 0 30px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0 2px;

  i {
    cursor: pointer;
    color: #999;
    transition: color 0.2s ease;

    &:hover {
      color: #fff;
      transform: scale(1.2);
    }
  }
}

.container-spacer {
  flex: 0 0 40px;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* ----------------------------------------- */
/*  Effect Tab Styles                        */
/* ----------------------------------------- */

.effects-list .item {

  .effect-source,
  .effect-duration,
  .effect-controls {
    text-align: center;
    border-left: 1px solid #4c4c44 !important;
    border-right: 1px solid #4c4c44 !important;
    font-size: 12px;
    padding: 4px 0;
  }

  .item-name h4 {
    margin-bottom: 0px !important;
    padding: 4px 0 4px 4px;
    border-right: 1px solid #4c4c44 !important;
  }

  .effect-controls {
    border: none;
  }
}

.effects-list h3.effect-name {
  margin-right: 18px;
}

.effects-list a.effect-control {
  text-align: center;
}

.effects-list .effect-source {
  text-align: center;
}

.effects-list ol.item-list>li:nth-child(odd) {
  background-color: #bebcb1;
}

.save-header {
  background: linear-gradient(to bottom, #2c2c2c, #252525);
  color: white;
  padding: 12px;
  text-align: center;
  font-weight: bold;
  border-radius: 6px 6px 0 0;
  margin-bottom: 12px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  display: flex;
  flex-direction: column;
  gap: 8px;

  .save-actions {
    display: flex;
    flex-direction: column;
    gap: 8px;
    align-items: center;
    margin-top: 4px;

    .select-tokens {
      width: 200px;
      background: #4a4a4a;
      border: 1px solid #666;
      border-radius: 4px;
      color: white;
      padding: 4px 8px;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 4px;

      &:hover {
        background: #5a5a5a;
        border-color: #777;
        transform: translateY(-1px);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      }

      &:active {
        transform: translateY(0);
        box-shadow: none;
      }

      i {
        font-size: 14px;
      }

      &[data-action="select-successful"] {
        background: #2d5a27;
        border-color: #3a7233;

        &:hover {
          background: #366b2f;
          border-color: #45803c;
        }
      }

      &[data-action="select-failed"] {
        background: #8b2a2a;
        border-color: #a83232;

        &:hover {
          background: #a83232;
          border-color: #c43c3c;
        }
      }
    }
  }
}

.save-group {
  margin: 12px 0;
  border: 1px solid #ddd;
  border-radius: 6px;
  overflow: hidden;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  background: white;

  .save-group-header {
    background: linear-gradient(to bottom, #f8f8f8, #f0f0f0);
    padding: 8px 12px;
    font-weight: bold;
    border-bottom: 1px solid #ddd;
    color: #333;
    font-size: 14px;
  }

  .save-list {
    list-style: none;
    margin: 0;
    padding: 0;

    .save-item {
      padding: 8px 12px;
      border-bottom: 1px solid #eee;
      font-size: 14px;
      color: #444;
      transition: background-color 0.2s ease;

      .token-name {
        font-weight: bold;
        color: #2c2c2c;
      }

      .roll-details {
        color: #666;
        font-size: 0.95em;
        margin-left: 4px;
      }

      &:hover {
        background-color: #f8f8f8;
      }

      &:last-child {
        border-bottom: none;
      }
    }
  }
}

/* Save Dialog Styles */
.save-dialog {
  gap: 1em;
  padding: 0.5em;
  min-width: 400px;

  .save-dialog-header {
    display: flex;
    justify-content: center;
    align-items: center;
    place-content: center;
    gap: 0.5em;
  }

  h3 {
    margin: 0;
    padding: 0.5em 0;
    border-bottom: 1px solid #ccc;
    font-size: 1.1em;
    text-align: center;
    font-weight: bold;
  }

  .save-dialog-body {
    display: flex;
    flex-direction: column;
    gap: 0.5em;

    p {
      margin: 0;
      font-style: italic;
      color: #666;
    }
  }

  .form-group {
    &.flexrow {
      align-items: center;
      gap: 0.5em;

      label {
        flex: 0 0 180px;
        font-weight: bold;
      }

      input[type="number"] {
        flex: 0 0 80px;
        text-align: center;
      }
    }

    &.flexcol {
      gap: 0.5em;
    }
  }

  .token-modifiers {
    display: flex;
    flex-direction: column;
    gap: 0.5em;
  }
}